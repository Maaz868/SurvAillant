{% extends "header.html" %} 
  {% load static %}
  {% block content %} 

  <link href="{% static 'anomaly.css' %}" rel="stylesheet">
  <main id="main" class="main">
    <section class="section">
      <div class="row">
        <div class="col-lg-12">

          <div class="card">
            <div class="card-body">
              <h5 class="card-title" style="color:#3e4f6f">Detailed Reports</h5>

              <!-- Default Accordion -->
              <div class="accordion" id="accordionExample">
              {% for anomaly in security %}
              <div class="accordion-item">
                <h2 class="accordion-header" id="heading{{ anomaly.id }}">
                  <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ anomaly.id }}" aria-expanded="false" aria-controls="collapse{{ anomaly.id }}">
                    Security Threat #{{ anomaly.id }}
                  </button>
                </h2>
                <div id="collapse{{ anomaly.id }}" class="accordion-collapse collapse" aria-labelledby="heading{{ anomaly.id }}" data-bs-parent="#accordionExample">
                  <div class="accordion-body">
                    <table class="table">
                      <tbody>
                        <tr>
                          <td>Source IP</td>
                          <td>{{ anomaly.src_ip }}</td>
                        </tr>
                        <tr>
                          <td>Destination IP</td>
                          <td>{{ anomaly.dst_ip }}</td>
                        </tr>
                        <tr>
                          <td>Source Port</td>
                          <td>{{ anomaly.src_port}}</td>
                        </tr>
                        <tr>
                          <td>Destination Port</td>
                          <td>{{ anomaly.dst_port }}</td>
                        </tr>
                        <tr>
                          <td>Payload Size</td>
                          <td>{{ anomaly.payload_size }}</td>
                        </tr>
                        <tr>
                          <td>Window Size</td>
                          <td>{{ anomaly.window_size }}</td>
                        </tr>
                        <tr>
                          <td>Num Packets Source</td>
                          <td>{{ anomaly.num_pkts_src }}</td>
                        </tr>
                        <tr>
                          <td>Num Packets Destination</td>
                          <td>{{ anomaly.num_pkts_dst }}</td>
                        </tr>
                        <tr>
                          <td>modbus function code</td>
                          <td>{{ anomaly.modbus_function_code}}</td>
                        </tr>
                        <tr>
                          <td>TTL Value</td>
                          <td>{{ anomaly.ttl_value }}</td>
                        </tr>
                        
                        <!-- Add rows for other fields -->
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            {% endfor %}<!-- End Default Accordion Example -->

            </div>
          </div>

        </div>
      </div>
        
            </div>
         

        
    </section>

  </main><!-- End #main -->

  {% endblock %}



